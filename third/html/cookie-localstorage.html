<!doctype html>
<ul id="ul">
</ul>
<script>

  const ul = document.getElementById('ul');
  function appendLog(label, text) {
    const li = document.createElement('li');
    li.innerText = `${label}: ${text}`;
    ul.appendChild(li);
  }

  function start() {
    while (ul.firstChild) ul.removeChild(ul.firstChild)

    appendLog('Referrer', document.referrer);
    appendLog('StorageAccessAPI', typeof document.hasStorageAccess === 'function' && document.hasStorageAccess() ? 'Supported!' : 'Unsupported');

    const expires = new Date(Date.now() + 2592000000).toUTCString();

    const prevCookie = document.cookie.split(/;\s?/).find(element => element.indexOf('prevCookie') == 0);
    appendLog('PrevCookie', prevCookie ? prevCookie : 'Not Found');
    if (!prevCookie) document.cookie = `prevCookie=${Math.random()};expires=${expires}`;

    const cookieValue = Math.random();
    document.cookie = `cookie=${cookieValue};expires=${expires}`;
    appendLog('Cookie', document.cookie.indexOf(`cookie=${cookieValue}`) >= 0 ? 'Writable!' : 'Not Writable');

    const prevSecureCookie = document.cookie.split(/;\s?/).find(element => element.indexOf('prevSecureCookie') == 0);
    appendLog('PrevSecureCookie', prevSecureCookie ? prevSecureCookie : 'Not Found');
    if (!prevSecureCookie) document.cookie = `prevSecureCookie=${Math.random()};expires=${expires}`;

    const secureCookieValue = Math.random();
    document.cookie = `secureCookie=${secureCookieValue};secure;expires=${expires}`;
    appendLog('SecureCookie', document.cookie.indexOf(`secureCookie=${secureCookieValue}`) >= 0 ? 'Writable!' : 'Not Writable');

    const prevItem = localStorage.getItem('prevItem');
    appendLog('LocalStorage PrevItem', prevItem ? prevItem : 'Not Found');
    if (!prevItem) localStorage.setItem('prevItem', Math.random());

    localStorage.setItem('item', Math.random());
    const item = localStorage.getItem('item');
    appendLog('LocalStorage', item ? 'Writable!' : 'Not Writable');
  }
  start();
</script>
</ul>
